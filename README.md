# Лабораторная работа 4

## Описание проекта
Приложение сохраняет статистику проигрываемых песен, транслируемых на радио "Мегабайт". Оно автоматически обновляет базу данных, добавляя информацию о новом треке, 
если текущий трек отличается от последнего сохранённого. Данные сохраняются локально и могут быть просмотрены пользователем в режиме просмотра. 
Также можно прослушивать уже добавленные песни в плеер 

## Использованные технологии
1. Язык разработки - Java
2. База данных - SQLite
3. Распределённая система управления версиями - GitHub

## Основные функции приложения
1. **Хранение статистики**:
   - Приложение сохраняет данные о каждой проигрываемой песне в базе данных. Таблица включает:
     - **ID** — уникальный идентификатор записи
     - **Исполнитель** — имя исполнителя
     - **Название трека** — название проигрываемой песни
     - **Время внесения записи** — дата и время добавления песни в базу данных

2. **Проверка интернет-подключения**:
   - При запуске приложения выполняется проверка подключения к Интернету
   - В случае отсутствия подключения отображается всплывающее сообщение (**Toast**), информирующее о запуске в автономном режиме. В этом режиме доступен только просмотр ранее сохранённых данных.

3. **Асинхронный опрос сервера**:
   - Приложение выполняет асинхронные запросы к API каждые 20 секунд, чтобы получить информацию о текущем треке
   - Если полученный трек отличается от последнего сохранённого, он добавляется в базу данных

4. **Просмотр статистики**:
   - Приложение содержит активити для просмотра всех записанных данных о песнях. Данные отображаются в виде списка, где каждая запись содержит информацию об исполнителе, названии трека и времени внесения.

5. **Прослушивание треков**:
   - Включение музыки и его перемотка. Наслаждайтесь своими любимыми треками
     
## API-интеграция
- Приложение использует HTTP-запрос к URL `https://media.ifmo.ru/api_get_current_song.php` для получения информации о текущей песне.
- https для безопасного обмена данными
- Запрос отправляется методом POST с передачей параметров:
  - `login`: 4707login
  - `password`: 4707pass
- В ответе API возвращает данные в формате JSON:
  - При успешном выполнении запроса ответ имеет вид: `{"result": "success", "info": "Исполнитель - Название трека"}`
  - В случае ошибки API возвращает: `{"result": "error", "info": "Информация об ошибке"}`

## Дополнительные разрешения

1. **`android.permission.INTERNET`**: разрешает приложению доступ к интернету.
   Оно необходимо для выполнения сетевых операций, таких как отправка запросов к API, загрузка данных из сети и передача информации между устройством и удаленным сервером

3. **`android.permission.ACCESS_NETWORK_STATE`**: разрешает приложению проверять состояние сети.
   Это позволяет определить, подключено ли устройство к интернету (Wi-Fi или мобильная сеть) или работает в автономном режиме. В приложении это важно для вывода предупреждения в случае отсутствия подключения к интернету

## Инструкция по использованию
1. Запустите приложение
2. На главной экране будт плеер для прослушивания песен
3. При наличии подключения к Интернету приложение начнёт опрос сервера каждые 20 секунд и автоматически обновит базу данных при смене трека
4. Каждые 20 секунд пользователь будет информироваться о добавлении нового трека или если он еще не сменился
5. При отсутствии подключения отобразится уведомление, и приложение перейдёт в автономный режим, предоставляя доступ к просмотру ранее записанных данных
6. Нажмити кнопку "радио" для просмотра статистики, чтобы увидеть список всех записей о проигрываемых песнях

## Зависимости
Для работы приложения требуются следующие классы и компоненты Android:
- **NotificationManager** для уведомлений о статусе
- **PendingIntent** и **BroadcastReceiver** для планирования и запуска повторяющихся задач
- **AlarmManager** для периодического выполнения запроса к серверу
- **AsyncTask** для асинхронного выполнения сетевых запросов
